<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <!-- =========================
       (1) T√çTULO DE LA PESTA√ëA
       ========================= -->
  <title>Alexandra & Daniel | Nuestra Boda</title>

  <!-- =========================
       (2) FUENTES (Google Fonts)
       - "Great Vibes": estilo caligr√°fico (como el ejemplo)
       - "Montserrat": legible para textos
       ========================= -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    /* =========================
       (3) VARIABLES DE COLORES
       ========================= */
    :root{
      --fondo: #fffaf5;
      --texto: #5a4a42;
      --dorado: #c49b6c;
      --verde: #8fb9a8;
      --gris: #6f6a66;
      --tarjeta: #ffffff;
      --borde: #e9e2dc;
      --boton: #9aa08e; /* tono parecido al ejemplo del bot√≥n */
    }

    /* =========================
       (4) ESTILOS GENERALES
       ========================= */
    body{
      margin: 0;
      font-family: "Montserrat", Arial, sans-serif;
      background: var(--fondo);
      color: var(--texto);
      text-align: center;
    }

    /* Contenedor principal para que todo quede ‚Äúbonito‚Äù */
    .wrap{
      max-width: 900px;
      margin: 0 auto;
      padding: 18px 16px 60px;
    }

    /* L√≠nea divisoria suave */
    .divider{
      width: 100%;
      max-width: 740px;
      height: 1px;
      background: #e8e0d9;
      margin: 26px auto;
      opacity: .9;
    }

    /* T√≠tulo script (la fuente bonita del ejemplo) */
    .script-title{
      font-family: "Great Vibes", cursive;
      font-weight: 400;
      color: #5d524c;
      line-height: 1;
    }

    /* Subt√≠tulos con letra normal */
    .subtle{
      color: var(--gris);
      font-weight: 400;
    }

    /* =========================
       (5) PORTADA / FOTO PRINCIPAL
       ========================= */
    .hero{
      background: transparent;
      padding-top: 6px;
    }

    /* Imagen de portada (foto principal) */
    .hero img{
      width: 100%;
      max-height: 520px;
      object-fit: cover;
      border-radius: 18px;
      border: 1px solid var(--borde);
      box-shadow: 0 8px 25px rgba(0,0,0,.06);
    }

    /* =========================
       (6) SECCI√ìN INTRO
       ========================= */
    .intro{
      margin-top: 14px;
      padding: 10px 10px 0;
    }

    .intro .mini-title{
      letter-spacing: 4px;
      font-size: 14px;
      color: #6f6a66;
      font-weight: 600;
      margin: 14px 0 6px;
    }

    .intro .big-script{
      font-size: 62px;
      margin: 0;
    }

    .intro .invite-line{
      margin: 8px 0 0;
      font-size: 18px;
      color: #6f6a66;
      font-weight: 400;
    }

    /* Texto inicial (m√°s peque√±o como pediste) */
    .intro-text{
      max-width: 760px;
      margin: 18px auto 0;
      font-size: 16px;          /* m√°s peque√±o */
      line-height: 1.8;
      color: #5f5752;
    }

    /* √ânfasis en negrita suave */
    .strong{
      font-weight: 700;
      color: #4f4742;
    }

    /* =========================
       (7) NOMBRES + FECHA + LUGAR
       ========================= */
    .names-block{
      padding: 6px 10px 0;
    }

    /* "Nuestra Boda" (script) */
    .event-label{
      font-size: 44px;
      margin: 0;
    }

    /* Nombres (script, como pediste) */
    .names{
      font-size: 64px;
      margin: 10px 0 6px;
      color: var(--dorado);
    }

    /* Fecha grande (verde suave) */
    .date-big{
      font-size: 46px;
      margin: 0;
      color: var(--verde);
      font-weight: 700;
    }

    /* Lugar */
    .place{
      margin-top: 8px;
      font-size: 20px;
      color: #6f6a66;
    }
    .place b{ color:#6a5e58; }

    /* =========================
       (8) COUNTDOWN
       ========================= */
    .countdown-card{
      background: var(--tarjeta);
      border: 1px solid var(--borde);
      border-radius: 18px;
      padding: 18px 14px;
      max-width: 740px;
      margin: 0 auto;
      box-shadow: 0 8px 20px rgba(0,0,0,.05);
    }

    .section-title{
      font-family: "Great Vibes", cursive; /* Titulos de cada seccion en la misma fuente */
      font-size: 48px;
      margin: 0 0 12px;
      color: #5d524c;
    }

    .countdown-grid{
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 10px;
      margin-top: 10px;
    }

    .time-box{
      background: #fbf7f3;
      border: 1px solid #eee4dc;
      border-radius: 14px;
      padding: 12px 8px;
    }

    .time-num{
      font-size: 28px;
      font-weight: 800;
      color: #4f4742;
    }

    .time-lbl{
      font-size: 12px;
      letter-spacing: 1px;
      color: #6f6a66;
      margin-top: 6px;
      text-transform: uppercase;
    }

    @media (max-width: 640px){
      .intro .big-script{ font-size: 54px; }
      .names{ font-size: 48px; }
      .date-big{ font-size: 34px; }
      .section-title{ font-size: 42px; }
      .countdown-grid{ grid-template-columns: repeat(2, 1fr); }
    }

    /* =========================
       (9) M√öSICA
       ========================= */
    .music-card{
      background: var(--tarjeta);
      border: 1px solid var(--borde);
      border-radius: 18px;
      padding: 16px 14px;
      max-width: 740px;
      margin: 0 auto;
      box-shadow: 0 8px 20px rgba(0,0,0,.05);
    }

    .btn{
      background: var(--boton);
      color: white;
      border: none;
      padding: 14px 18px;
      font-size: 16px;
      font-weight: 700;
      border-radius: 12px;
      cursor: pointer;
      width: min(420px, 100%);
      letter-spacing: 1px;
    }
    .btn:active{ transform: scale(.99); }

    .small-note{
      font-size: 13px;
      color: #6f6a66;
      margin-top: 10px;
      line-height: 1.5;
    }

    /* =========================
       (10) TARJETAS GENERALES (VESTIMENTA, WHATSAPP, RSVP, ETC.)
       ========================= */
    .card{
      background: var(--tarjeta);
      border: 1px solid var(--borde);
      border-radius: 18px;
      padding: 18px 14px;
      max-width: 740px;
      margin: 0 auto;
      box-shadow: 0 8px 20px rgba(0,0,0,.05);
      text-align: left; /* Para que se vea tipo formulario */
    }

    .card p, .card li{
      color: #5f5752;
      line-height: 1.65;
      margin: 10px 0;
      font-size: 16px;
    }

    /* Im√°genes dentro de tarjeta */
    .ref-img{
      width: 100%;
      border-radius: 14px;
      border: 1px solid var(--borde);
      margin-top: 10px;
      object-fit: cover;
      max-height: 380px;
    }

    /* =========================
       (11) SECCI√ìN R√ÅFAGA DE FOTOS
       ========================= */
    .photo-wall{
      background: var(--tarjeta);
      border: 1px solid var(--borde);
      border-radius: 18px;
      padding: 14px;
      max-width: 740px;
      margin: 0 auto;
      box-shadow: 0 8px 20px rgba(0,0,0,.05);
    }

    /* ‚ÄúMasonry‚Äù simple con columnas CSS */
    .masonry{
      column-count: 2;
      column-gap: 12px;
    }
    @media (min-width: 900px){
      .masonry{ column-count: 3; }
    }

    .masonry img{
      width: 100%;
      border-radius: 14px;
      margin: 0 0 12px;
      break-inside: avoid;
      border: 1px solid var(--borde);
      box-shadow: 0 6px 16px rgba(0,0,0,.06);
    }

    /* =========================
       (12) FORMULARIO RSVP estilo ‚ÄúConfirmar Asistencia‚Äù
       ========================= */
    .rsvp-title{
      font-family: "Montserrat", Arial, sans-serif;
      font-size: 36px;
      font-weight: 800;
      letter-spacing: 2px;
      color: #4f4a46;
      text-align: center;
      margin: 0 0 10px;
    }

    .rsvp-sub{
      text-align: center;
      color: #6f6a66;
      margin: 0 0 18px;
    }

    .rsvp-row{
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
      margin: 10px 0 14px;
    }
    @media (max-width: 640px){
      .rsvp-row{ grid-template-columns: 1fr; }
    }

    label{
      display: block;
      font-size: 14px;
      color: #6f6a66;
      margin: 10px 0 8px;
    }

    input, select, textarea{
      width: 100%;
      padding: 14px 14px;
      border-radius: 12px;
      border: 1px solid #ded6cf;
      outline: none;
      font-size: 16px;
      font-family: "Montserrat", Arial, sans-serif;
      background: #fff;
      box-sizing: border-box;
    }

    textarea{
      min-height: 120px;
      resize: vertical;
    }

    .radio-line{
      display:flex;
      justify-content:center;
      align-items:center;
      gap: 28px;
      margin: 10px 0 18px;
      color: #6f6a66;
      font-size: 18px;
    }
    .radio-line label{
      margin: 0;
      font-size: 18px;
      cursor: pointer;
    }
    .radio-line input{
      width: auto;
      margin-right: 10px;
      transform: scale(1.2);
    }

    .center{
      text-align: center;
    }

    .rsvp-btn{
      margin-top: 14px;
      text-transform: uppercase;
      font-weight: 800;
      letter-spacing: 2px;
    }

    /* Mensajes de √©xito/error */
    .msg{
      margin-top: 12px;
      padding: 12px 14px;
      border-radius: 12px;
      display: none;
      font-size: 14px;
      line-height: 1.5;
    }
    .msg.ok{
      background: #e9f7f0;
      border: 1px solid #bde8cf;
      color: #1f6b45;
    }
    .msg.err{
      background: #fdecec;
      border: 1px solid #f5bdbd;
      color: #8b1a1a;
    }

    /* Link WhatsApp */
    .wa{
      text-decoration: none;
      color: #1d7c4f;
      font-weight: 700;
    }
  </style>
</head>

<body>
  <div class="wrap">

    <!-- =========================
         (A) PORTADA (FOTO PRINCIPAL)
         - Debes subir: foto-portada.jpg
         ========================= -->
    <section class="hero">
      <img src="foto-portada.jpg" alt="Foto de portada de Alexandra y Daniel" />
    </section>

    <!-- =========================
         (B) INTRO SUPERIOR
         - T√≠tulo con la fuente bonita (Great Vibes)
         ========================= -->
    <section class="intro">
      <div class="mini-title">EST√ÅS INVITADO A</div>
      <h1 class="script-title big-script">nuestra boda</h1>
      <p class="invite-line">Nos encantar√≠a que seas parte de este momento tan especial para nosotros.</p>

      <div class="divider"></div>

      <!-- Texto inicial (sin la canci√≥n) -->
      <p class="intro-text">
        Teniendo principalmente como testigo y gu√≠a de nuestra historia a <span class="strong">Dios</span>,
        sin temor a equivocarnos y con la firme convicci√≥n de que el final de esta historia solo lo decidir√° √âl
        cuando apague alguno de nuestros corazones, <span class="strong">hemos decidido unir nuestras vidas en matrimonio.</span>
        <br><br>
        Y como cada uno de ustedes conoce y ha sido parte de nuestra historia, tenemos el gusto de contarles e invitarlos a:
        <br>
        <span class="strong">Nuestra Boda</span>
      </p>
    </section>

    <div class="divider"></div>

    <!-- =========================
         (C) BLOQUE PRINCIPAL (NOMBRES / FECHA / LUGAR)
         - "Nuestra Boda" reemplaza "Nos casamos"
         - Nombres en fuente script
         ========================= -->
    <section class="names-block">
      <h2 class="script-title event-label">Nuestra Boda</h2>

      <h3 class="script-title names">Alexandra Gil &amp; Daniel Alvarez</h3>

      <p class="date-big">Viernes 13 de noviembre de 2026</p>

      <p class="place">
        <b>Lugar:</b> Pendiente por confirmar (Cove√±as, Sucre)
      </p>
    </section>

    <div class="divider"></div>

    <!-- =========================
         (D) CUENTA REGRESIVA COMPLETA
         - Muestra d√≠as, horas, minutos, segundos
         ========================= -->
    <section>
      <div class="countdown-card">
        <h2 class="section-title">Cuenta regresiva</h2>
        <p class="subtle" style="margin:0 0 10px;">Faltan...</p>

        <div class="countdown-grid">
          <div class="time-box">
            <div id="cd-days" class="time-num">0</div>
            <div class="time-lbl">D√≠as</div>
          </div>
          <div class="time-box">
            <div id="cd-hours" class="time-num">0</div>
            <div class="time-lbl">Horas</div>
          </div>
          <div class="time-box">
            <div id="cd-mins" class="time-num">0</div>
            <div class="time-lbl">Minutos</div>
          </div>
          <div class="time-box">
            <div id="cd-secs" class="time-num">0</div>
            <div class="time-lbl">Segundos</div>
          </div>
        </div>

        <p id="cd-status" class="small-note" style="margin-bottom:0;"></p>
      </div>
    </section>

    <div class="divider"></div>

    <!-- =========================
         (E) M√öSICA
         - Subir el archivo MP3 como: musica.mp3
         - Intentamos autoplay (si el navegador lo bloquea, mostramos bot√≥n)
         - Tambi√©n activamos al primer toque en pantalla
         ========================= -->
    <section>
      <div class="music-card">
        <h2 class="section-title">M√∫sica</h2>

        <!-- Audio (loop para que se repita) -->
        <audio id="music" loop>
          <source src="musica.mp3" type="audio/mpeg">
          Tu navegador no soporta audio.
        </audio>

        <button id="btnMusic" class="btn">‚ñ∂ Activar m√∫sica</button>

        <p class="small-note" id="musicNote">
          Nota: algunos celulares/navegadores requieren que presiones un bot√≥n o toques la pantalla para activar el sonido.
        </p>
      </div>
    </section>

    <div class="divider"></div>

    <!-- =========================
         (F) VESTIMENTA (con espacio para im√°genes de referencia)
         - Subir:
           - vestimenta-hombres.jpg
           - vestimenta-mujeres.jpg
         ========================= -->
    <section>
      <div class="card">
        <h2 class="section-title" style="text-align:center;">Vestimenta</h2>

        <!-- HOMBRES -->
        <p class="strong">Hombres</p>
        <ul>
          <li>Camisa de lino o manga larga (preferiblemente clara).</li>
          <li>Pantal√≥n beige/arena o tonos neutros.</li>
          <li>Estilo playero elegante.</li>
        </ul>
        <img class="ref-img" src="vestimenta-hombres.jpg" alt="Referencia vestimenta hombres" />

        <div class="divider"></div>

        <!-- MUJERES -->
        <p class="strong">Mujeres</p>
        <ul>
          <li>Vestidos en tonos pasteles o neutros, estilo elegante y fresco.</li>
          <li><span class="strong">Recomendaci√≥n:</span> por ser en playa, es mejor evitar tac√≥n (ideal sandalias/flat).</li>
        </ul>
        <img class="ref-img" src="vestimenta-mujeres.jpg" alt="Referencia vestimenta mujeres" />

        <p class="small-note" style="margin-top:12px;">
          (Estas im√°genes son solo una gu√≠a de estilo).
        </p>
      </div>
    </section>

    <div class="divider"></div>

    <!-- =========================
         (G) SECCI√ìN DE FOTOS ‚ÄúR√ÅFAGA‚Äù
         - Debes crear carpeta /fotos/ y subir 15 im√°genes:
           fotos/01.jpg ... fotos/15.jpg
         ========================= -->
    <section>
      <div class="photo-wall">
        <h2 class="section-title" style="text-align:center;">Fotos</h2>
        <p class="subtle" style="margin:0 0 12px; text-align:center;">
          Algunos recuerdos que nos encantan üíõ
        </p>

        <div class="masonry">
          <!-- 15 fotos (puedes cambiar por las tuyas) -->
          <img src="fotos/01.jpg" alt="Foto 01">
          <img src="fotos/02.jpg" alt="Foto 02">
          <img src="fotos/03.jpg" alt="Foto 03">
          <img src="fotos/04.jpg" alt="Foto 04">
          <img src="fotos/05.jpg" alt="Foto 05">
          <img src="fotos/06.jpg" alt="Foto 06">
          <img src="fotos/07.jpg" alt="Foto 07">
          <img src="fotos/08.jpg" alt="Foto 08">
          <img src="fotos/09.jpg" alt="Foto 09">
          <img src="fotos/10.jpg" alt="Foto 10">
          <img src="fotos/11.jpg" alt="Foto 11">
          <img src="fotos/12.jpg" alt="Foto 12">
          <img src="fotos/13.jpg" alt="Foto 13">
          <img src="fotos/14.jpg" alt="Foto 14">
          <img src="fotos/15.jpg" alt="Foto 15">
        </div>
      </div>
    </section>

    <div class="divider"></div>

    <!-- =========================
         (H) MENSAJE DE CONFIRMACI√ìN (POLITE, con plazo de 1 mes)
         - Calculamos fecha l√≠mite = hoy + 30 d√≠as
         ========================= -->
    <section>
      <div class="card" style="text-align:center;">
        <h2 class="section-title">Confirmaci√≥n</h2>
        <p style="margin:0;">
          Por favor confirma tu asistencia dentro de los pr√≥ximos <span class="strong">30 d√≠as</span>
          (<span class="strong">fecha l√≠mite:</span> <span id="deadlineDate">‚Äî</span>).
          <br>
          Si no recibimos tu confirmaci√≥n dentro de ese plazo, entenderemos (con todo cari√±o) que no podr√°s asistir,
          para poder organizar todo de la mejor manera.
        </p>
      </div>
    </section>

    <div class="divider"></div>

    <!-- =========================
         (I) WHATSAPP (link directo)
         - Enlace directo a WhatsApp: https://wa.me/573028610838
         ========================= -->
    <section>
      <div class="card" style="text-align:center;">
        <h2 class="section-title">Dudas o preguntas</h2>
        <p style="margin:0;">
          Si tienes cualquier duda, escr√≠benos por WhatsApp:
          <br>
          <a class="wa" href="https://wa.me/573028610838" target="_blank" rel="noopener">
            üì≤ +57 302 861 0838
          </a>
        </p>
      </div>
    </section>

    <div class="divider"></div>

    <!-- =========================
         (J) FORMULARIO RSVP (tipo imagen que enviaste)
         - Guarda en Google Sheets usando tu Apps Script URL
         - Soporta invitaci√≥n de 1 a 6 personas
         - Bloqueo local para evitar doble env√≠o (cliente)
         ========================= -->
    <section>
      <div class="card">
        <div class="rsvp-title">CONFIRMAR ASISTENCIA</div>
        <p class="rsvp-sub">Por favor, confirma tu asistencia. ¬°Esperamos que est√©s all√≠!</p>

        <!-- Mensaje de √©xito/error -->
        <div id="msgOk" class="msg ok"></div>
        <div id="msgErr" class="msg err"></div>

        <!-- FORM -->
        <form id="rsvpForm">
          <!-- Radios: Asiste / No asiste -->
          <div class="radio-line">
            <label>
              <input type="radio" name="asistencia" value="S√≠, all√≠ estar√©" checked>
              S√≠, all√≠ estar√©!
            </label>
            <label>
              <input type="radio" name="asistencia" value="No podr√© asistir">
              No podr√© asistir
            </label>
          </div>

          <!-- Responsable -->
          <label for="responsable">Nombre del responsable (quien confirma)</label>
          <input id="responsable" name="responsable" type="text" placeholder="Ej: Andr√©s Alvarez" required>

          <!-- Cantidad -->
          <label for="cantidad">¬øCu√°ntas personas incluye esta invitaci√≥n?</label>
          <select id="cantidad" name="cantidad" required>
            <option value="1">1 persona</option>
            <option value="2">2 personas</option>
            <option value="3">3 personas</option>
            <option value="4">4 personas</option>
            <option value="5">5 personas</option>
            <option value="6">6 personas</option>
          </select>

          <!-- Contenedor din√°mico de invitados 1..6 -->
          <div id="invitadosContainer"></div>

          <!-- Alergias -->
          <label for="alergias">Intolerancias o alergias alimentarias</label>
          <input id="alergias" name="alergias" type="text" placeholder="Ej: Ninguna">

          <!-- Canci√≥n -->
          <label for="cancion">¬øQu√© canci√≥n no puede faltar?</label>
          <input id="cancion" name="cancion" type="text" placeholder="Ej: ...">

          <!-- Mensaje -->
          <label for="mensaje">Mensaje para los novios</label>
          <textarea id="mensaje" name="mensaje" placeholder="D√©janos un mensaje üíõ"></textarea>

          <div class="center">
            <button id="btnEnviar" type="submit" class="btn rsvp-btn">ENVIAR RESPUESTA</button>
            <p class="small-note">
              *Tu respuesta quedar√° guardada autom√°ticamente en Google Sheets.
            </p>
          </div>
        </form>
      </div>
    </section>

  </div>

  <script>
    /* =========================================================
       CONFIGURACI√ìN (CAMBIA SOLO SI LO NECESITAS)
       ========================================================= */

    // (1) Fecha del evento: Viernes 13 de noviembre de 2026, 4:00 PM (ajusta hora si quieres)
    const EVENT_DATE = new Date("November 13, 2026 16:00:00").getTime();

    // (2) URL de tu Apps Script (la que compartiste)
    const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyfFfm4Xi_17QaxKPAN8RLziPAw1NiYuByWMy6ttifwUANZecb_v5DNStsm5pCtvhzk7w/exec";

    // (3) Llave local para bloquear doble env√≠o en el mismo dispositivo
    const LOCAL_SENT_KEY = "rsvp_enviado_alexandra_daniel_v1";

    /* =========================================================
       (1) CUENTA REGRESIVA (d√≠as/horas/min/seg)
       ========================================================= */
    function pad2(n){ return String(n).padStart(2,"0"); }

    function updateCountdown(){
      const now = Date.now();
      let diff = EVENT_DATE - now;

      const status = document.getElementById("cd-status");
      if (diff <= 0){
        document.getElementById("cd-days").textContent = "0";
        document.getElementById("cd-hours").textContent = "00";
        document.getElementById("cd-mins").textContent = "00";
        document.getElementById("cd-secs").textContent = "00";
        status.textContent = "¬°Hoy es el gran d√≠a! üíõ";
        return;
      }

      const days = Math.floor(diff / (1000*60*60*24));
      diff -= days * (1000*60*60*24);

      const hours = Math.floor(diff / (1000*60*60));
      diff -= hours * (1000*60*60);

      const mins = Math.floor(diff / (1000*60));
      diff -= mins * (1000*60);

      const secs = Math.floor(diff / 1000);

      document.getElementById("cd-days").textContent = days;
      document.getElementById("cd-hours").textContent = pad2(hours);
      document.getElementById("cd-mins").textContent = pad2(mins);
      document.getElementById("cd-secs").textContent = pad2(secs);

      status.textContent = "Preparando todo con mucho cari√±o ‚ú®";
    }
    setInterval(updateCountdown, 1000);
    updateCountdown();

    /* =========================================================
       (2) FECHA L√çMITE CONFIRMACI√ìN (HOY + 30 D√çAS)
       ========================================================= */
    function setDeadline(){
      const d = new Date();
      d.setDate(d.getDate() + 30);

      // Formato bonito en espa√±ol
      const opts = { year:"numeric", month:"long", day:"numeric" };
      document.getElementById("deadlineDate").textContent = d.toLocaleDateString("es-CO", opts);
    }
    setDeadline();

    /* =========================================================
       (3) M√öSICA
       - Intento de autoplay: puede fallar por pol√≠ticas del navegador
       - Si falla, el usuario debe tocar el bot√≥n o tocar la pantalla
       ========================================================= */
    const music = document.getElementById("music");
    const btnMusic = document.getElementById("btnMusic");
    const musicNote = document.getElementById("musicNote");

    async function tryPlayMusic(){
      try{
        await music.play();
        btnMusic.textContent = "‚è∏ M√∫sica activada";
        musicNote.textContent = "M√∫sica reproduci√©ndose üéµ";
      }catch(e){
        // Autoplay bloqueado (normal en m√≥viles)
        musicNote.textContent = "Tu navegador bloque√≥ el autoplay. Toca el bot√≥n (o toca la pantalla) para activar el audio.";
      }
    }

    // Bot√≥n para activar m√∫sica manualmente
    btnMusic.addEventListener("click", async () => {
      if (!music.paused){
        music.pause();
        btnMusic.textContent = "‚ñ∂ Activar m√∫sica";
        musicNote.textContent = "M√∫sica pausada.";
        return;
      }
      await tryPlayMusic();
    });

    // ‚ÄúModo inteligente‚Äù: primer toque/click en cualquier parte activa m√∫sica
    // (Muy √∫til en iPhone: el usuario toca para scrollear y ah√≠ se activa)
    let firstInteraction = false;
    function onFirstInteraction(){
      if (firstInteraction) return;
      firstInteraction = true;
      tryPlayMusic();
      window.removeEventListener("click", onFirstInteraction);
      window.removeEventListener("touchstart", onFirstInteraction);
    }
    window.addEventListener("click", onFirstInteraction, { passive:true });
    window.addEventListener("touchstart", onFirstInteraction, { passive:true });

    // Intento inicial de autoplay (probablemente ser√° bloqueado en m√≥viles)
    tryPlayMusic();

    /* =========================================================
       (4) RSVP: CAMPOS DIN√ÅMICOS PARA INVITADOS 1..6
       ========================================================= */
    const cantidadSelect = document.getElementById("cantidad");
    const invitadosContainer = document.getElementById("invitadosContainer");

    function renderInvitados(){
      const n = Number(cantidadSelect.value || 1);

      // Limpiamos el contenedor
      invitadosContainer.innerHTML = "";

      // Creamos inputs Invitado 1..n
      for (let i=1; i<=n; i++){
        const label = document.createElement("label");
        label.setAttribute("for", "inv"+i);
        label.textContent = "Nombre del invitado " + i;

        const input = document.createElement("input");
        input.id = "inv"+i;
        input.name = "inv"+i;
        input.type = "text";
        input.placeholder = "Ej: Nombre Apellido";
        input.required = true;

        invitadosContainer.appendChild(label);
        invitadosContainer.appendChild(input);
      }
    }
    cantidadSelect.addEventListener("change", renderInvitados);
    renderInvitados(); // Inicial

    /* =========================================================
       (5) RSVP: ENV√çO A GOOGLE APPS SCRIPT
       - Env√≠a JSON con: asistencia, responsable, cantidad, invitados[], alergias, cancion, mensaje, info
       - Bloquea doble env√≠o (cliente) usando localStorage
       ========================================================= */
    const form = document.getElementById("rsvpForm");
    const msgOk = document.getElementById("msgOk");
    const msgErr = document.getElementById("msgErr");
    const btnEnviar = document.getElementById("btnEnviar");

    function showMsg(el, text){
      el.style.display = "block";
      el.textContent = text;
    }
    function hideMsgs(){
      msgOk.style.display = "none";
      msgErr.style.display = "none";
      msgOk.textContent = "";
      msgErr.textContent = "";
    }

    // Si ya envi√≥ antes desde este navegador
    if (localStorage.getItem(LOCAL_SENT_KEY) === "1"){
      showMsg(msgErr, "Este dispositivo/navegador ya registr√≥ una confirmaci√≥n. Si necesitas corregir algo, cont√°ctanos por WhatsApp.");
      btnEnviar.disabled = true;
      btnEnviar.style.opacity = .6;
    }

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      hideMsgs();

      // Bloqueo local (cliente) antes de enviar
      if (localStorage.getItem(LOCAL_SENT_KEY) === "1"){
        showMsg(msgErr, "Ya existe una confirmaci√≥n registrada desde este dispositivo/navegador.");
        return;
      }

      // Tomar asistencia
      const asistencia = form.querySelector('input[name="asistencia"]:checked')?.value || "";

      // Responsable
      const responsable = document.getElementById("responsable").value.trim();

      // Cantidad
      const cantidad = Number(document.getElementById("cantidad").value || 0);

      // Invitados
      const invitados = [];
      for (let i=1; i<=cantidad; i++){
        const v = (document.getElementById("inv"+i)?.value || "").trim();
        if (v) invitados.push(v);
      }

      // Otros campos
      const alergias = (document.getElementById("alergias").value || "").trim();
      const cancion  = (document.getElementById("cancion").value  || "").trim();
      const mensaje  = (document.getElementById("mensaje").value  || "").trim();

      // ‚ÄúInfo‚Äù (User-Agent) para tu l√≥gica de bloqueo (NO es IP real)
      const info = navigator.userAgent;

      // Payload EXACTO como tu Apps Script espera
      const payload = {
        asistencia,
        responsable,
        cantidad,
        invitados,
        alergias,
        cancion,
        mensaje,
        info
      };

      // Enviar
      try{
        btnEnviar.disabled = true;
        btnEnviar.textContent = "ENVIANDO...";

        const res = await fetch(APPS_SCRIPT_URL, {
          method: "POST",
          headers: { "Content-Type": "text/plain;charset=utf-8" },
          body: JSON.stringify(payload)
        });

        const data = await res.json();

        if (data.ok){
          showMsg(msgOk, data.message || "Confirmaci√≥n registrada correctamente.");
          localStorage.setItem(LOCAL_SENT_KEY, "1"); // Bloqueo local para no duplicar
        }else{
          showMsg(msgErr, data.message || "No se pudo registrar. Intenta nuevamente.");
          btnEnviar.disabled = false;
          btnEnviar.textContent = "ENVIAR RESPUESTA";
        }

      }catch(err){
        showMsg(msgErr, "Error enviando el formulario. Revisa tu conexi√≥n e intenta de nuevo.");
        btnEnviar.disabled = false;
        btnEnviar.textContent = "ENVIAR RESPUESTA";
      }
    });
  </script>
</body>
</html>
